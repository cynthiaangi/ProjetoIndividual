<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles/reset.css">
    <link rel="stylesheet" href="./styles/style.css">
    <link rel="icon" href="./img/logo.png">
    <title>Voz do Amor</title>
</head>
<body>
    <header class="cabecalho">
        <div class="cabecalho-titulo">
            <img class="cabecalho-titulo-img" src="./img/logo.png" alt="Logo site">
            <h1>
                Voz do amor
            </h1>
        </div>
        <nav class="cabecalho-navegacao">
            <a href="./index.html"> Home</a>
            <a href="">Sobre Mim</a>
            <a href="./login.html">Grupo de Apoio</a>
        </nav>
    </header>
    <main class="login">
        <img src="./img/simbolo_colorido.png" alt="Símbolo da conscientização da perda gestacional">
        <section id="card-login">
            <div class="campo">
                e-mail: <input id="ipt_email_login" type="text" placeholder="Digite seu e-mail">
            </div>
            <div class="campo">
                senha: <input id="ipt_senha_login" type="text" placeholder="Insira a sua senha">
            </div>

            <button class="botoes" onclick="entrar()">Entrar</button>
            <button class="botoes" onclick="alterarMain()">Novo Usuário</button>
        </section>
        <section id="card-cadastro">
            <div id="div_erro"></div>
            <div class="campo">   
                Nome:* <input id="ipt_nome" type="text" placeholder="Digite seu nome">
            </div>
            <div class="campo">    
                Data de Nascimento:* <input id="ipt_nasc" type="text" placeholder="DD/MM/AAAA">
            </div>
            <div class="campo">    
                Gênero:* 
               <select name="genero" id="sel_gen">
                    <option value="#">Escolha uma opção</option>
                    <option value="feminino">Feminino</option>
                    <option value="masculino">Masculino</option>
               </select>
            </div>
            <div class="campo">    
                E-mail:* <input id="ipt_email" type="text" placeholder="nome@provedor.com">
            </div>
            <div class="campo">    
                Telefone:* <input id="ipt_tel" type="text" placeholder="(XX) 99999-9999">
            </div>
            <div class="campo">      
                Senha:* <input id="ipt_senha" type="password" placeholder="Informe uma senha">
                <div id="valida-senha">
                    <li>1 Letra Maiúscula</li>
                    <li>1 Letra Minúscula</li>
                    <li>1 Número</li>
                    <li>1 caractere especial ( !@#$%&* )</li>
                    <li>Mínimo 8 caracteres</li>
                </div>
            </div>
            <div class="campo">     
                Confirmação de senha:* <input id="ipt_conf" type="password" placeholder="Informe a senha novamente">
            </div>

                <button class="botoes" onclick="cadastrar()">Cadastrar</button>
                <button class="botoes" onclick="voltar()">Voltar</button>

        </section>
    </main>
    <footer class="rodape">
        <h4>
            Desenvolvido por Cynthia Angi
        </h4>
    </footer>
</body>
</html>

<script>
    function alterarMain(){
        var login = document.getElementById('card-login');
        var cadastro = document.getElementById('card-cadastro');

        login.style.display = 'none';
        cadastro.style.display = 'flex';
    }

    function voltar(){
        var login = document.getElementById('card-login');
        var cadastro = document.getElementById('card-cadastro');

        login.style.display = 'flex';
        cadastro.style.display = 'none';
    }

    function entrar(){
        var email = ipt_email_login.value;
        var senha = ipt_senha_login.value;

        if(senha == senha_cadastro && email == email_cadastro){
            alert('Bem vindo');
            
        } else{
            alert('Usuario ou senha incorretos!')
        }
    }

    function cadastrar(){
        div_erro.innerHTML = '';
        // ipt_conf.clear();
        // ipt_nome.clear();
        // ipt_nasc.clear();
        // ipt_gen.clear();
        // ipt_email.clear();
        // ipt_senha.clear();
        // ipt_tel.clear();
        var nome = ipt_nome.value;
        var dtNasc = ipt_nasc.value;
        var gen = sel_gen.value;
        var email = ipt_email.value;
        var senha = ipt_senha.value;
        var conf = ipt_conf.value;
        var tel = ipt_tel.value;
        var arroba = '';
        var pontoCom = email.indexOf('.com');
        var arroba = email.indexOf('@');
        var senhaOk = 0;
        var senhaMaiusc = senha.toUpperCase();
        var senhaMinusc = senha.toLowerCase();
        var especial = '!@#$%&*';
        var numero = '1234567890';

        if (nome == '' || dtNasc == '' || gen == '#' || email == '' || senha == '' || conf == ''){
            div_erro.innerHTML = `<p>Todos os campos com (*) devem estar preenchidos!</p><p>Tente novamente.</p>`;
        } else{
            for(var i = 0; i < dtNasc.length; i++){
                if(i == 2 || i == 5){
                    if(dtNasc[i] != '/'){
                        dtNasc = false;
                        break;
                    }
                }
            } 
            if(dtNasc.length != 10 || dtNasc == false){
                div_erro.innerHTML = `<p>Formato de data inválido!</p><p>Tente novamente.</p>`;
            } else{
                for(var j = 0; j < tel.length; j++){
                    if(j == 0){
                        if(tel[j] != '('){
                            tel = false;
                            break;
                        }
                    }
                    if(j == 3){
                        if(tel[j] != ')'){
                            tel = false;
                            break;
                        }
                    }
                    if(j == 9){
                        if(tel[j] != '-'){
                            tel = false;
                            break;
                        }
                    }
                }
                if(tel.length != 14 || tel == false){
                    div_erro.innerHTML = `<p>Número de telefone formato inválido!</p><p>Tente novamente.</p>`;
                }else if (nome.length < 3){
                    div_erro.innerHTML = `<p>O nome precisa conter pelo menos 3 letras!</p><p>Tente novamente.</p>`;
                } else if(gen != 'feminino'){
                    div_erro.innerHTML = `<p>Infelizmente você não pode se cadastrar em nosso grupo de apoio.</p><p>Agradecemos o interesse!</p>`;
                } else if(pontoCom < arroba || arroba == -1 || pontoCom == -1){
                    div_erro.innerHTML = `<p>Formato de email inválido!</p><p>Tente novamente.</p>`;
                }  else  {
                    for(var k = 0; k < senha.length; k++){
                        if(Number(senha[k]) != NaN){
                            senhaOk++;
                            break;
                        }
                    }
                    for(var x = 0; x < senha.length; x++){
                        if(especial.includes(senha[x])){
                            senhaOk++;
                            break;
                        }
                    }
                    if(senhaOk != 2 || senha == senhaMaiusc || senha == senhaMinusc || senha.length < 8){
                        div_erro.innerHTML = `<p>A senha precisa conter todos os itens listados abaixo do campo!</p><p>Tente novamente.</p>`;
                    } else if(conf != senha){
                        div_erro.innerHTML = `<p>A confirmação da senha está diferente da senha informada!</p><p>Tente novamente.</p>`;
                    }else{
                        alert('Cadastro realizado com sucesso, retornando para a tela de login');
                        voltar();
                    }
                }
            }
        }
    }
        
</script>