<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles/reset.css">
    <link rel="stylesheet" href="./styles/style.css">
    <link rel="icon" href="./img/logo.png">
    <title>Voz do Amor</title>
</head>
<body>
    <header class="cabecalho">
        <div class="cabecalho-titulo">
            <img class="cabecalho-titulo-img" src="./img/logo.png" alt="Logo site">
            <h1>
                Voz do amor
            </h1>
        </div>
        <nav class="cabecalho-navegacao">
            <a href="./index.html"> Home</a>
            <a href="">Sobre Mim</a>
            <a href="./login.html">Grupo de Apoio</a>
        </nav>
    </header>
    <main class="login">
        <img class="img-login" src="./img/simbolo_colorido-removebg-preview.png" alt="Símbolo da conscientização da perda gestacional">
        <section id="card-login">
            <div class="campo">
                e-mail: <input id="ipt_email_login" type="text" placeholder="Digite seu e-mail">
            </div>
            <div class="campo">
                senha: <input id="ipt_senha_login" type="text" placeholder="Insira a sua senha">
            </div>

            <button class="botoes" onclick="entrar()">Entrar</button>
            <button class="botoes" onclick="alterarMain()">Novo Usuário</button>
        </section>
        <section id="card-cadastro">
            <div id="div_erro"></div>
            <div class="campo">   
                Nome:* <input id="ipt_nome" type="text" placeholder="Digite seu nome">
            </div>
            <div class="campo">    
                Data de Nascimento:* <input id="ipt_nasc" type="text" placeholder="DD/MM/AAAA">
            </div>
            <div class="campo">    
                Gênero:* 
               <select name="genero" id="sel_gen">
                    <option value="#">Escolha uma opção</option>
                    <option value="feminino">Feminino</option>
                    <option value="masculino">Masculino</option>
               </select>
            </div>
            <div class="campo">    
                E-mail:* <input id="ipt_email" type="text" placeholder="nome@provedor.com">
            </div>
            <div class="campo">    
                Telefone:* <input id="ipt_tel" type="text" placeholder="(XX) 99999-9999">
            </div>
            <div class="campo">      
                Senha:* <input id="ipt_senha" type="password" placeholder="Informe uma senha">
                <div id="valida-senha">
                    <li>1 Letra Maiúscula</li>
                    <li>1 Letra Minúscula</li>
                    <li>1 Número</li>
                    <li>1 caractere especial ( !@#$%&* )</li>
                    <li>Mínimo 8 caracteres</li>
                </div>
            </div>
            <div class="campo">     
                Confirmação de senha:* <input id="ipt_conf" type="password" placeholder="Informe a senha novamente">
            </div>

                <button class="botoes" onclick="cadastrar()">Cadastrar</button>
                <button class="botoes" onclick="voltar()">Voltar</button>

        </section>
    </main>
    <footer class="rodape">
        <h4>
            Desenvolvido por Cynthia Angi
        </h4>
    </footer>
</body>
</html>

<script>
    function limparCadastro(){
        document.getElementById('ipt_nome').value = "";
        document.getElementById('ipt_nasc').value = "";
        document.getElementById('ipt_email').value = "";
        document.getElementById('ipt_senha').value = "";
        document.getElementById('ipt_conf'). value = "";
        document.getElementById('ipt_tel').value = "";
    }

    function alterarMain(){
        var login = document.getElementById('card-login');
        var cadastro = document.getElementById('card-cadastro');

        login.style.display = 'none';
        cadastro.style.display = 'flex';
        limparCadastro();
    }

    function voltar(){
        var login = document.getElementById('card-login');
        var cadastro = document.getElementById('card-cadastro');

        login.style.display = 'flex';
        cadastro.style.display = 'none';
    }

    function entrar(){
        var email = ipt_email_login.value;
        var senha = ipt_senha_login.value;

        if(senha == senha_cadastro && email == email_cadastro){
            alert('Bem vindo');
            
        } else{
            alert('Usuario ou senha incorretos!')
        }
    }

    function cadastrar(){
        div_erro.innerHTML = '';
        var nome = ipt_nome.value;
        var dtNasc = ipt_nasc.value;
        var gen = sel_gen.value;
        var email = ipt_email.value;
        var senha = ipt_senha.value;
        var conf = ipt_conf.value;
        var tel = ipt_tel.value;
        var arroba = '';
        var pontoCom = email.indexOf('.com');
        var arroba = email.indexOf('@');
        var senhaOk = 0;
        var senhaMaiusc = senha.toUpperCase();
        var senhaMinusc = senha.toLowerCase();
        var especial = '!@#$%&*';
        var numero = '1234567890';

        if (nome == '' || dtNasc == '' || gen == '#' || email == '' || senha == '' || conf == ''){
            div_erro.innerHTML = `<p>Todos os campos com (*) devem estar preenchidos!</p><p>Tente novamente.</p>`;
        } else{
            for(var i = 0; i < dtNasc.length; i++){
                if(i == 2 || i == 5){
                    if(dtNasc[i] != '/'){
                        dtNasc = false;
                        break;
                    }
                }
            } 
            if(dtNasc.length != 10 || dtNasc == false){
                div_erro.innerHTML = `<p>Formato de data inválido!</p><p>Tente novamente.</p>`;
            } else{
                for(var j = 0; j < tel.length; j++){
                    if(j == 0){
                        if(tel[j] != '('){
                            tel = false;
                            break;
                        }
                    }
                    if(j == 3){
                        if(tel[j] != ')'){
                            tel = false;
                            break;
                        }
                    }
                    if(j == 9){
                        if(tel[j] != '-'){
                            tel = false;
                            break;
                        }
                    }
                }
                if(tel.length != 14 || tel == false){
                    div_erro.innerHTML = `<p>Número de telefone formato inválido!</p><p>Tente novamente.</p>`;
                }else if (nome.length < 3){
                    div_erro.innerHTML = `<p>O nome precisa conter pelo menos 3 letras!</p><p>Tente novamente.</p>`;
                } else if(gen != 'feminino'){
                    div_erro.innerHTML = `<p>Infelizmente você não pode se cadastrar em nosso grupo de apoio.</p><p>Agradecemos o interesse!</p>`;
                } else if(pontoCom < arroba || arroba == -1 || pontoCom == -1){
                    div_erro.innerHTML = `<p>Formato de email inválido!</p><p>Tente novamente.</p>`;
                }  else  {
                    for(var k = 0; k < senha.length; k++){
                        if(Number(senha[k]) != NaN){
                            senhaOk++;
                            break;
                        }
                    }
                    for(var x = 0; x < senha.length; x++){
                        if(especial.includes(senha[x])){
                            senhaOk++;
                            break;
                        }
                    }
                    if(senhaOk != 2 || senha == senhaMaiusc || senha == senhaMinusc || senha.length < 8){
                        div_erro.innerHTML = `<p>A senha precisa conter todos os itens listados abaixo do campo!</p><p>Tente novamente.</p>`;
                    } else if(conf != senha){
                        div_erro.innerHTML = `<p>A confirmação da senha está diferente da senha informada!</p><p>Tente novamente.</p>`;
                    }else{
                        alert('Cadastro realizado com sucesso, retornando para a tela de login');            
                        voltar();
                    }
                }
            }
        }
    }
        


// // Enviando o valor da nova input
// fetch("/usuarios/cadastrar", {
//     method: "POST",
//     headers: {
//       "Content-Type": "application/json",
//     },
//     body: JSON.stringify({
//       // crie um atributo que recebe o valor recuperado aqui
//       // Agora vá para o arquivo routes/usuario.js
//       nomeServer: nome,
//       dataServer: data,
//       generoServer: genero,
//       emailServer: email,
//       telefoneServer: telefone,
//       senhaServer: senha,
//     }),
//   })
//     .then(function (resposta) {
//       console.log("resposta: ", resposta);

//       if (resposta.ok) {

//         var cep = ipt_cep.value;
//         var num = ipt_num.value;
//         var cidade = ipt_cidade.value;
//         var estado = ipt_estado.value;
//         var tam_cep = cep.length;
//         var tam_num = num.length;
//         var tam_cidade = cidade.length;
//         var tam_estado = estado.length;
//         var cep_int = parseInt(cep);
//         var num_int = parseInt(num);
      
//         if (
//           tam_num == 0 ||
//           tam_cep == 0 ||
//           tam_cidade == 0 ||
//           tam_estado == 0
//         ) {
//           alert("Todos os campos devem ser inseridos!");
//         } else if (tam_cep < 8 || cep_int != cep || cep < 0) {
//           alert("O CEP deve ser um número inteiro com 8 digítos!");
//         } else if (num_int != num || num < 0) {
//           alert("O número deve ser um valor inteiro!");
//         } else{
//           estrutura.innerHTML = `
//              <header>
//                  <img src="./img/logo-png.png" class="logo">
//              </header>
//              <div class="container-login">
//                  <div class="card cadastro">
//                      <h1>Cadastro realizado com sucesso!</h1>
//                      <a href="login.html"><img width="100px" src="./img/verificar.png"></a>
//                      <div class=cadastro_realizado>
//                          <span>Clique no botão verde para ser redirecionado a tela tela de login.</span>
//                      </div>
//                  </div>
//              </div>
//              <footer>
//                  <span> &copy; 2024 DataTech Security </span>
//              </footer>`;

//              fetch("/enderecos/cadastrar", {
//                 method: "POST",
//                 headers: {
//                   "Content-Type": "application/json",
//                 },
//                 body: JSON.stringify({
//                   // crie um atributo que recebe o valor recuperado aqui
//                   // Agora vá para o arquivo routes/usuario.js
//                   empresaServer: empresa,
//                   nomeServer: nome,
//                   repreServer: repre,
//                   cnpjServer: cnpj,
//                   emailServer: email,
//                   usuarioServer: usuario,
//                   senhaServer: senha,
//                 }),
//               })
//                 .then(function (resposta) {
//                   console.log("resposta: ", resposta);
            
//                   if (resposta.ok) {

//                   } else {

//                   }
        
//                 }).catch(function (resposta) {
//           console.log(`#ERRO: ${resposta}`);
//           finalizarAguardar();
//         });
    
//       return false;
//     }
//         cardErro.style.display = "block";

//         mensagem_erro.innerHTML =
//           "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

//         setTimeout(() => {
//           window.location = "login.html";
//         }, "2000");

//         limparFormulario();
//         finalizarAguardar();
//       } else {
//         throw "Houve um erro ao tentar realizar o cadastro!";
//       }
//     })
//     .catch(function (resposta) {
//       console.log(`#ERRO: ${resposta}`);
//       finalizarAguardar();
//     });

//   return false;


// // Listando empresas cadastradas 
// function listar() {
//   fetch("/empresas/listar", {
//     method: "GET",
//   })
//     .then(function (resposta) {
//       resposta.json().then((empresas) => {
//         empresas.forEach((empresa) => {
//           listaEmpresasCadastradas.push(empresa);

//           console.log("listaEmpresasCadastradas")
//           console.log(listaEmpresasCadastradas[0].codigo_ativacao)
//         });
//       });
//     })
//     .catch(function (resposta) {
//       console.log(`#ERRO: ${resposta}`);
//     });
// }
//   //VALIDAÇÂO TAMANHO
//   if (
//     tam_email == 0 ||
//     tam_empresa == 0 ||
//     tam_nome == 0 ||
//     tam_usuario == 0 ||
//     tamanho_senha == 0 ||
//     tam_confirmacao == 0 ||
//     tam_repre == 0
//   ) {
//     alert("Todos os campos devem ser inseridos!");
//   } else if (tam_cnpj < 14 || cnpj_int != cnpj || cnpj < 0) {
//     alert("O CNPJ deve ser um número inteiro com 14 digítos!");
//   } else if (
//     arroba_email == false ||
//     posi_arroba > posi_com ||
//     (com_email == false && br_email == false)
//   ) {
//     alert("O email deve terminar com '.com' ou '.br' \n Deve conter '@' ");
//   } else if (
//     especial_exclamacao_user ||
//     especial_arroba_user ||
//     especial_hastag_user ||
//     especial_cifrao_user ||
//     especial_porcentagem_user ||
//     especial_ecomercial_user ||
//     user_sem_espaco != usuario
//   ) {
//     alert(
//       "O nome de usuário não pode conter nenhum desses caracteres especiais (!, @, #, $, %, &) nem espaço!"
//     );
//   } else if (
//     tamanho_senha >= 8 &&
//     tamanho_senha <= 12 &&
//     minuscula_senha != senha &&
//     maiuscula_senha != senha &&
//     (especial_exclamacao ||
//       especial_arroba ||
//       especial_hastag ||
//       especial_cifrao ||
//       especial_porcentagem ||
//       especial_ecomercial) &&
//     (zero_senha ||
//       um_senha ||
//       dois_senha ||
//       tres_senha ||
//       quat_senha ||
//       cinco_senha ||
//       seis_senha ||
//       sete_senha ||
//       oito_senha ||
//       nove_senha) &&
//     senha == comfirmacao
//   ) {
//     continuacao.innerHTML = `
//         <div id="continuacao" class="formulario-cadastro">
//           <div class="form-column">
//                 <div class="campo">
//               <span>CEP:</span>
//               <input class="ipt_cadastro" type="number" id="ipt_cep" placeholder="00000000" />
//             </div>
//             <div class="campo">
//               <span>Número:</span>
//               <input class="ipt_cadastro" type="number" id="ipt_num" placeholder="Digite o número" />
//             </div>
//             <div class="campo">
//               <span>Cidade:</span>
//               <input
//                 class="ipt_cadastro"
//                 type="text"
//                 id="ipt_cidade"
//                 placeholder="Digite a cidade"
//               />
//             </div>
//             <div class="campo">
//               <span>Estado:</span>
//               <input
//                 class="ipt_cadastro"
//                 type="text"
//                 id="ipt_estado"
//                 placeholder="Digite o Estado"
//               />
//             </div>
//           </div>
//         </div>
//      </div>       
//     <button onclick="cadastrar1()" class="button">Cadastrar</button>`;
//     seguinte.style.display= 'none';
//   } else {
//     alert(
//       "A senha deve conter ao menos: \n- 1 letra Maiuscula \n- 1 letra minuscula \n- 1 número \n- 1 caractere especial (!, @, #, $, %, &); \n A confirmação deve ser igual a senha descrita no campo anterior!"
//     );
//   }
</script>